package org.apache.jsp.admin;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.smart4c.util.SpringUtils;
import com.smart4c.dao.*;
import com.smart4c.bean.*;
import java.util.*;
import com.smart4c.common.*;
import net.sf.json.*;

public final class serviceMgt_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final JspFactory _jspxFactory = JspFactory.getDefaultFactory();

  private static java.util.List _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.AnnotationProcessor _jsp_annotationprocessor;

  public Object getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_annotationprocessor = (org.apache.AnnotationProcessor) getServletConfig().getServletContext().getAttribute(org.apache.AnnotationProcessor.class.getName());
  }

  public void _jspDestroy() {
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");

String ctx = request.getContextPath();
SmartProperties hxProp = SmartProperties.getInstance();
int maxThumbnail = hxProp.getIntProperty("max_count_shop_thumbnail");
if (maxThumbnail < 1) {
	maxThumbnail = 1;
}

ServiceClassDao scDao = (ServiceClassDao)SpringUtils.getBean(ServiceClassDao.class);
ServiceProjectDao spjDao = (ServiceProjectDao)SpringUtils.getBean(ServiceProjectDao.class);
List<ServiceClass> scList = scDao.getAllClass();
StringBuffer scBuf = new StringBuffer();
JSONObject spjTree = new JSONObject();
for (ServiceClass sc : scList) {
	scBuf.append(sc.getId() + ":" + sc.getName());
	scBuf.append(";");
	JSONObject children = new JSONObject();
	List<ServiceProject> spjList = spjDao.getProjectsByClsId(sc.getId());
	for (ServiceProject spj : spjList) {
		JSONObject item = new JSONObject();
		item.put("name", spj.getName());
		item.put("id", spj.getId());
		item.put("type", "item");
		children.put(spj.getName(), item);
	}
	JSONObject addParam = new JSONObject();
	addParam.put("children", children);
	JSONObject spjObj = new JSONObject();
	spjObj.put("additionalParameters", addParam);
	spjObj.put("id", sc.getId());
	spjObj.put("type", "folder");
	spjObj.put("name", sc.getName());
	spjTree.put(sc.getName(), spjObj);
	
}
if (scBuf.length() > 1) {
	scBuf.deleteCharAt(scBuf.length() - 1);
}


      out.write("\r\n");
      out.write("<!DOCTYPE html>\r\n");
      out.write("<html>\r\n");
      out.write("\t<head>\r\n");
      out.write("\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n");
      out.write("\t\t<title>汽车服务后台管理</title>\r\n");
      out.write("\t\r\n");
      out.write("\t\t<meta name=\"description\" content=\"overview &amp; stats\" />\r\n");
      out.write("\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- basic styles -->\r\n");
      out.write("\r\n");
      out.write("\t\t<link href=\"");
      out.print(ctx );
      out.write("/assets/css/bootstrap.min.css\" rel=\"stylesheet\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/font-awesome.min.css\" />\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if IE 7]>\r\n");
      out.write("\t\t  <link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/font-awesome-ie7.min.css\" />\r\n");
      out.write("\t\t<![endif]-->\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- page specific plugin styles -->\r\n");
      out.write("\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/jquery-ui-1.10.3.full.min.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/bootstrap-timepicker.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ui.jqgrid.css\" />\r\n");
      out.write("\t\t<!-- \r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx);
      out.write("/assets/css/zTreeStyle/zTreeStyle.css\" type=\"text/css\">\r\n");
      out.write("\t\t-->\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- fonts -->\r\n");
      out.write("\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ace-fonts.css\" />\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- ace styles -->\r\n");
      out.write("\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ace.min.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ace-rtl.min.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ace-skins.min.css\" />\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ajaxfileupload.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/common.css\" />\r\n");
      out.write("\t\t<link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/global-min.css\" />\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if lte IE 8]>\r\n");
      out.write("\t\t  <link rel=\"stylesheet\" href=\"");
      out.print(ctx );
      out.write("/assets/css/ace-ie.min.css\" />\r\n");
      out.write("\t\t<![endif]-->\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- inline styles related to this page -->\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- ace settings handler -->\r\n");
      out.write("\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/ace-extra.min.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if lt IE 9]>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/html5shiv.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/respond.min.js\"></script>\r\n");
      out.write("\t\t<![endif]-->\r\n");
      out.write("\t\t<style type=\"text/css\">\r\n");
      out.write("\t\t*,*:before,*:after{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}\r\n");
      out.write("\t\tol,ul {list-style: outside none none;}\r\n");
      out.write("\t\t*,*:before,*:after{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}\r\n");
      out.write("\t\t.ui-autocomplete {\r\n");
      out.write("\t\t\theight: 200px;\r\n");
      out.write("\t\t\twidth: 400px;\r\n");
      out.write("\t\t\toverflow-y: scroll;\r\n");
      out.write("\t\t\t/* prevent horizontal scrollbar */\r\n");
      out.write("\t\t\toverflow-x: hidden;\r\n");
      out.write("\t\t\t/* add padding to account for vertical scrollbar */\r\n");
      out.write("\t\t\tpadding-right: 20px;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t/* IE 6 doesn't support max-height\r\n");
      out.write("\t\t* we use height instead, but this forces the menu to always be this tall\r\n");
      out.write("\t\t*/\r\n");
      out.write("\t\t* html .ui-autocomplete {\r\n");
      out.write("\t\theight: 100px;\r\n");
      out.write("\t\t\t} \r\n");
      out.write("\t\t</style>\r\n");
      out.write("\t</head>\r\n");
      out.write("\t<body class=\"skin-4\">\r\n");
      out.write("\t\t<div class=\"main-container\" id=\"main-container\">\r\n");
      out.write("\t\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\t\ttry{ace.settings.check('main-container' , 'fixed')}catch(e){}\r\n");
      out.write("\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t<div class=\"main-container-inner\">\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t\t<div class=\"breadcrumbs\" id=\"breadcrumbs\">\r\n");
      out.write("\t\t\t\t\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\t\t\t\t\ttry{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}\r\n");
      out.write("\t\t\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t<ul class=\"breadcrumb\">\r\n");
      out.write("\t\t\t\t\t\t\t<li>\r\n");
      out.write("\t\t\t\t\t\t\t\t<i class=\"icon-home home-icon\"></i>\r\n");
      out.write("\t\t\t\t\t\t\t\t<a href=\"#\">首页</a>\r\n");
      out.write("\t\t\t\t\t\t\t</li>\r\n");
      out.write("\t\t\t\t\t\t\t<li>服务产品管理</li>\r\n");
      out.write("\t\t\t\t\t\t\t<li class=\"active\">列表</li>\r\n");
      out.write("\t\t\t\t\t\t</ul><!-- .breadcrumb -->\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t<div class=\"page-content\" style=\"margin-left: 8px; padding-left: 0px; overflow: hidden;\">\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t<div class=\"row\">\r\n");
      out.write("\t\t\t\t\t\t\t<div class=\"col-xs-12\">\r\n");
      out.write("\t\t\t\t\t\t\t\t<!-- PAGE CONTENT BEGINS -->\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<table id=\"grid-table\"></table>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<div id=\"grid-pager\"></div>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\tvar $path_base = \"/\";//this will be used in gritter alerts containing images\r\n");
      out.write("\t\t\t\t\t\t\t\t</script>\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t\t<!-- PAGE CONTENT ENDS -->\r\n");
      out.write("\t\t\t\t\t\t\t</div><!-- /.col -->\r\n");
      out.write("\t\t\t\t\t\t</div><!-- /.row -->\r\n");
      out.write("\t\t\t\t\t</div><!-- /.page-content -->\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t</div><!-- /.main-container-inner -->\r\n");
      out.write("\t\t\t<a id=\"btn-scroll-up\" class=\"btn-scroll-up btn btn-sm btn-inverse\" href=\"#\">\r\n");
      out.write("\t\t\t\t<i class=\"icon-double-angle-up icon-only bigger-110\"></i>\r\n");
      out.write("\t\t\t</a>\r\n");
      out.write("\t\t</div><!-- /.main-container -->\r\n");
      out.write("\r\n");
      out.write("\t\t<div id=\"allmap\"></div>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<!-- basic scripts -->\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if !IE]> -->\r\n");
      out.write("\r\n");
      out.write("\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\twindow.jQuery || document.write(\"<script src='");
      out.print(ctx );
      out.write("/assets/js/jquery-2.0.3.min.js'>\"+\"<\"+\"/script>\");\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx);
      out.write("/assets/js/ajaxfileupload.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- <![endif]-->\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if IE]>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write(" window.jQuery || document.write(\"<script src='");
      out.print(ctx );
      out.write("/assets/js/jquery-1.10.2.min.js'>\"+\"<\"+\"/script>\");\r\n");
      out.write("</script>\r\n");
      out.write("<![endif]-->\r\n");
      out.write("\r\n");
      out.write("\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\tif(\"ontouchend\" in document) document.write(\"<script src='");
      out.print(ctx );
      out.write("/assets/js/jquery.mobile.custom.min.js'>\"+\"<\"+\"/script>\");\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/bootstrap.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/typeahead-bs2.min.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- page specific plugin scripts -->\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/uncompressed/date-time/bootstrap-timepicker.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jqGrid/jquery.jqGrid.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jqGrid/i18n/grid.locale-cn.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!--[if lte IE 8]>\r\n");
      out.write("\t\t  <script src=\"");
      out.print(ctx );
      out.write("/assets/js/excanvas.min.js\"></script>\r\n");
      out.write("\t\t<![endif]-->\r\n");
      out.write("\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jquery-ui-1.10.3.full.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jquery.ui.touch-punch.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jquery.slimscroll.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jquery.easy-pie-chart.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/jquery.sparkline.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/flot/jquery.flot.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/flot/jquery.flot.pie.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/flot/jquery.flot.resize.min.js\"></script>\r\n");
      out.write("\t\t<!-- \r\n");
      out.write("\t\t<script type=\"text/javascript\" src=\"");
      out.print(ctx);
      out.write("/assets/js/ztree/jquery.ztree.core-3.5.js\"></script>\r\n");
      out.write("\t\t<script type=\"text/javascript\" src=\"");
      out.print(ctx);
      out.write("/assets/js/ztree/jquery.ztree.excheck-3.5.js\"></script>\r\n");
      out.write("\t\t-->\r\n");
      out.write("\t\r\n");
      out.write("\t\t<!-- page specific plugin scripts -->\r\n");
      out.write("\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/uncompressed/fuelux/fuelux.tree.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- ace scripts -->\r\n");
      out.write("\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/ace-elements.min.js\"></script>\r\n");
      out.write("\t\t<script src=\"");
      out.print(ctx );
      out.write("/assets/js/ace.min.js\"></script>\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t<script type=\"text/javascript\" src=\"http://api.map.baidu.com/api?v=1.3\"></script>\r\n");
      out.write("\r\n");
      out.write("\t\t<!-- inline scripts related to this page -->\r\n");
      out.write("\r\n");
      out.write("\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t\tfunction ajax_upload_pics(fileIds, picType, ulId, cb, which, maxCount) {\r\n");
      out.write("\t\t\t\t// check file size\r\n");
      out.write("\t\t\t\tif (which.files[0].size > 2097152) {\r\n");
      out.write("\t\t\t\t\talert(\"请上传不大于2M的图片！\");\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t$.ajaxFileUpload(\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\turl: \"");
      out.print(ctx);
      out.write("/uploadPics.do\",\r\n");
      out.write("\t\t\t\t\t\tsecureuri: false,\r\n");
      out.write("\t\t\t\t\t\tfileElementId: fileIds,\r\n");
      out.write("\t\t\t\t\t\tdataType: 'json',\r\n");
      out.write("\t\t\t\t\t\tdata: {picType: picType},\r\n");
      out.write("\t\t\t\t\t\tsuccess: function (data, status) {\r\n");
      out.write("\t\t\t\t\t\t\tif (typeof (data.success) != 'undefined') {\r\n");
      out.write("\t\t\t\t\t\t\t\tif (data.success == true) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tcb(maxCount, ulId, data.imgPath, data.imgName);\r\n");
      out.write("\t\t\t\t\t\t\t\t\tupdateImageFileInfo(\"shop_thumbnail\");\r\n");
      out.write("\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\talert(data.message);\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\terror: function (data, status, e) {\r\n");
      out.write("\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t);\r\n");
      out.write("\t\t\t}\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\tfunction onclickLiOper(maxCount) {\r\n");
      out.write("\t\t\t\tjQuery(\".moveup\").on(\"click\", function (e) {\r\n");
      out.write("\t\t\t\t\tvar li = jQuery(this).parent().parent().parent();\r\n");
      out.write("\t\t\t\t\tli.removeClass(\"last\");\r\n");
      out.write("\t\t\t\t\tli.prev().removeClass(\"first\");\r\n");
      out.write("\t\t\t\t\tli.insertBefore(li.prev());\r\n");
      out.write("\t\t\t\t\tli.parent().children(\"li:first\").addClass(\"first\");\r\n");
      out.write("\t\t\t\t\tli.parent().children(\"li:last\").addClass(\"last\");\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tvar ul = li.parent();\r\n");
      out.write("\t\t\t\t\tupdateImageFileInfo(\"shop_thumbnail\");\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tjQuery(\".movedown\").on(\"click\", function (e) {\r\n");
      out.write("\t\t\t\t\tvar li = jQuery(this).parent().parent().parent();\r\n");
      out.write("\t\t\t\t\tli.removeClass(\"first\");\r\n");
      out.write("\t\t\t\t\tli.next().removeClass(\"last\");\r\n");
      out.write("\t\t\t\t\tli.insertAfter(li.next());\r\n");
      out.write("\t\t\t\t\tli.parent().children(\"li:first\").addClass(\"first\");\r\n");
      out.write("\t\t\t\t\tli.parent().children(\"li:last\").addClass(\"last\");\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tupdateImageFileInfo(\"shop_thumbnail\");\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tjQuery(\".del\").on(\"click\", function(e) {\r\n");
      out.write("\t\t\t\t\tvar li = jQuery(this).parent().parent().parent();\r\n");
      out.write("\t\t\t\t\tvar ul = li.parent();\r\n");
      out.write("\t\t\t\t\tli.remove();\r\n");
      out.write("\t\t\t\t\tul.children(\"li:first\").addClass(\"first\");\r\n");
      out.write("\t\t\t\t\tul.children(\"li:last\").addClass(\"last\");\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tupdateImageFileInfo(\"shop_thumbnail\");\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t// show add photo div\r\n");
      out.write("\t\t\t\t\tif (maxCount == null) {\r\n");
      out.write("\t\t\t\t\t\tmaxCount = 1;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tif (ul.children().length < maxCount) {\r\n");
      out.write("\t\t\t\t\t\tjQuery(\"#J_UploadPic\").show();\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\tfunction updateImageFileInfo(type) {\r\n");
      out.write("\t\t\t\tif (type == null || type != \"shop_thumbnail\") {\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tvar imgList = jQuery(\"#J_UploadQueue img\");\r\n");
      out.write("\t\t\t\tvar imgValNode = jQuery(\"#pics\");\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tvar imgVal = \"\";\r\n");
      out.write("\t\t\t\tfor (var i = 0; i < imgList.length; i++) {\r\n");
      out.write("\t\t\t\t\t// /hongxi/admin/displayPic.do?imagePath=E:\\hongxi_image\\tyre\\detail&imageName=1426757544140.gif\r\n");
      out.write("\t\t\t\t\tvar src = imgList[i].src;\r\n");
      out.write("\t\t\t\t\tif (src == null || src == \"\") {\r\n");
      out.write("\t\t\t\t\t\tcontinue;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tvar start = src.indexOf(\"imagePath=\");\r\n");
      out.write("\t\t\t\t\tvar end = src.indexOf(\"&imageName=\");\r\n");
      out.write("\t\t\t\t\tif (start == -1 || end == -1) {\r\n");
      out.write("\t\t\t\t\t\tcontinue;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tvar path = src.substring(start + 10, end);\r\n");
      out.write("\t\t\t\t\tvar name = src.substring(end + 11);\r\n");
      out.write("\t\t\t\t\timgVal += path+\";\"+name;\r\n");
      out.write("\t\t\t\t\tif (i != (imgList.length - 1)) {\r\n");
      out.write("\t\t\t\t\t\timgVal += \"|\"\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tif (imgValNode != null) {\r\n");
      out.write("\t\t\t\t\timgValNode.val(imgVal);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tfunction addLiNode(maxCnt, ulId, imgPath, imgName) {\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tif (maxCnt == null) {\r\n");
      out.write("\t\t\t\t\tmaxCnt = 1;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tif (jQuery(\"#\"+ulId).children().length >= maxCnt) {\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tvar idx = imgName.substring(0, imgName.indexOf(\".\"));\r\n");
      out.write("\t\t\t\tjQuery(\"#\"+ulId+\" li:last\").removeClass(\"last\");\r\n");
      out.write("\t\t\t\tvar first = \"\";\r\n");
      out.write("\t\t\t\tif (jQuery(\"#\"+ulId+\" li\").length == 0) {\r\n");
      out.write("\t\t\t\t\tfirst = \"first\";\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tvar fileLi = jQuery(\"<li class=\\\"pic-box control-group \" + first + \" last success\\\" id=\\\"file-\" + idx + \"\\\"></li>\");\r\n");
      out.write("\t\t\t\tvar src = \"\";\r\n");
      out.write("\t\t\t\tif (imgPath != null && imgPath != \"\") {\r\n");
      out.write("\t\t\t\t\tsrc = \"");
      out.print(ctx);
      out.write("/displayPic.do?imagePath=\" + imgPath + \"&imageName=\" + imgName;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tvar showPic = \"<div class=\\\"pic sh-pic\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+ \"<a href=\\\"javascript:void(0);\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\t\"<img class=\\\"J_Pic_file-\" + idx + \"\\\" id=\\\"J_Pic_file-\" + idx + \"\\\" src=\\\"\"+ src + \"\\\" alt=\\\"图片上传失败,请重新上传！\\\" >\"\r\n");
      out.write("\t\t\t\t\t\t+\"</a>\"\r\n");
      out.write("\t\t\t\t\t\t//+\"<span class=\\\"rotate\\\"><b class=\\\"rotate-icon\\\"></b>旋转图片</span>\"\r\n");
      out.write("\t\t\t\t\t\t+\"<div class=\\\" J_Mask_file-\" + idx + \" pic-mask\\\" style=\\\"display: none;\\\"></div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"<div class=\\\"status-wrapper\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<div class=\\\"status waiting-status\\\" style=\\\"display: none;\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t\t<p>等待上传<br>请稍候</p>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<div class=\\\"status start-status progress-status success-status\\\" style=\\\"\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t\t\t<div class=\\\"J_ProgressBar_file-\" + idx + \" ks-progress-bar\\\" style=\\\"width: 100px; display: none;\\\" role=\\\"progressbar\\\" aria-valuemin=\\\"0\\\" aria-valuemax=\\\"100\\\" aria-valuenow=\\\"100\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t\t\t<div data-value=\\\"100\\\" class=\\\"ks-progress-bar-value\\\" style=\\\"width: 100px;\\\"></div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<div class=\\\"status error-status\\\" style=\\\"display: none;\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t\t<p class=\\\"J_ErrorMsg_file-\" + idx + \"\\\">服务器故障，请稍候再试！</p>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"</div>\"\r\n");
      out.write("\t\t\t\t\t\t+\"</div>\";\r\n");
      out.write("\t\t\t\tvar picAddon = \"<div class=\\\"pic-addon\\\">\"\r\n");
      out.write("\t\t\t\t\t\t//+\"<input id=\\\"J_Desc_file-\" + idx + \"\\\" placeholder=\\\"点击图片的响应地址\\\" type=\\\"text\\\" size=\\\"60\\\" maxlength=\\\"255\\\" onchange=\\\"updateImageFileInfo('shop_thumbnail')\\\">\"\r\n");
      out.write("\t\t\t\t\t\t+\"<div class=\\\"bar clearfix\\\">\"\r\n");
      out.write("\t\t\t\t\t\t//+\"\t<label class=\\\"radio\\\"><input type=\\\"radio\\\" name=\\\"setMain\\\" class=\\\"set-main\\\" value=\\\"\\\"> 设为首图</label>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<b class=\\\"moveup\\\">上移</b>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<b class=\\\"movedown\\\">下移</b>\"\r\n");
      out.write("\t\t\t\t\t\t+\"\t<b class=\\\"del J_Del_file-\"+idx+\"\\\">删除</b>\"\r\n");
      out.write("\t\t\t\t\t\t+\"</div>\"\r\n");
      out.write("\t\t\t\t\t+\"</div>\";\r\n");
      out.write("\t\t\t\tfileLi.append(jQuery(showPic));\r\n");
      out.write("\t\t\t\tfileLi.append(jQuery(picAddon));\r\n");
      out.write("\t\t\t\tjQuery(\"#\"+ulId).append(fileLi);\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tif (jQuery(\"#\"+ulId).children().length >= maxCnt) {\r\n");
      out.write("\t\t\t\t\t// hide add photo div\r\n");
      out.write("\t\t\t\t\tjQuery(\"#J_UploadPic\").hide();\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tonclickLiOper(maxCnt);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tjQuery.jgrid.ajaxOptions.type = 'post'; // fixed 中文乱码\r\n");
      out.write("\t\t\tjQuery(function($) {\r\n");
      out.write("\t\t\t\tvar grid_selector = \"#grid-table\";\r\n");
      out.write("\t\t\t\tvar pager_selector = \"#grid-pager\";\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\tjQuery(grid_selector).jqGrid({\r\n");
      out.write("\t\t\t\t\t//direction: \"rtl\",\r\n");
      out.write("\t\t\t\t\turl: \"");
      out.print(ctx);
      out.write("/admin/getSProducts.do\",\r\n");
      out.write("\t\t\t\t\t//data: grid_data,\r\n");
      out.write("\t\t\t\t\tdatatype: \"json\",\r\n");
      out.write("\t\t\t\t\theight: 391,\r\n");
      out.write("\t\t\t\t\tcolNames:['ID','类别','项目','项目Id','产品名称','摘要','配件','促销价格','原价','时长','首页显示','产品描述','图片详情','产品图标','图标路径','状态'],\r\n");
      out.write("\t\t\t\t\tcolModel:[\r\n");
      out.write("\t\t\t\t\t\t{name:'s.id',index:'s.id',hidden:true,editable:false},\r\n");
      out.write("\t\t\t\t\t\t{name:'sc',index:'sc',editable:true,edittype:\"text\"},\r\n");
      out.write("\t\t\t\t\t\t{name:'project',index:'project',editable:true,edittype:\"text\",editoptions:{readonly:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'spjId', index:'spjId',editable:false,hidden:true},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.title',index:'s.title',editable:true,edittype:'text',editrules:{required:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.abstract_',index:'s.abstract_',editable:true,edittype:'text',editrules:{required:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.accessory',index:'s.accessory',editable:true,edittype:'text',editrules:{required:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.newprice',index:'s.newprice',editable:true,edittype:'text',editrules:{required:true,number:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.oldprice',index:'s.oldprice',editable:true,edittype:'text',editrules:{required:true,number:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.duration',index:'s.duration',editable:true,edittype:'text',editrules:{required:true,integer:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.isfirst',index:'s.isfirst',editable:true,edittype:'select',editoptions:{value:\"1:是;0:否\"}},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.description',index:'s.description',editable:true,edittype:'textarea',editrules:{required:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'pics',index:'pics',hidden:true,editable:true,edittype:\"text\",editrules:{edithidden:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'icon',index:'icon',hidden:true,search:false,sortable:false,editable:true,edittype:\"file\",editoptions:{enctype:\"multipart/form-data\"},editrules:{edithidden:true}},\r\n");
      out.write("\t\t\t\t\t\t{name:'iconPN',index:'iconPN',hidden:true,search:false,sortable:false,editable:true,edittype:\"text\"},\r\n");
      out.write("\t\t\t\t\t\t{name:'s.status',index:'s.status',editable:true,edittype:'select',editoptions:{value:\"0:上架;1:已下架\"}}\r\n");
      out.write("\t\t\t\t\t], \r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\tviewrecords : true,\r\n");
      out.write("\t\t\t\t\trowNum:10,\r\n");
      out.write("\t\t\t\t\trowList:[10,20,30],\r\n");
      out.write("\t\t\t\t\tsortname: \"s.id\",\r\n");
      out.write("\t\t\t\t\tsortorder: \"asc\",\r\n");
      out.write("\t\t\t\t\tjsonReader: {\r\n");
      out.write("\t                        root:\"dataRows\",                // 数据行（默认为：rows）\r\n");
      out.write("\t                        page: \"curPage\",            // 当前页\r\n");
      out.write("\t                        total: \"totalPages\",    // 总页数\r\n");
      out.write("\t                        records: \"totalRecords\",    // 总记录数\r\n");
      out.write("\t                        repeatitems : false                // 设置成false，在后台设置值的时候，可以乱序。且并非每个值都得设\r\n");
      out.write("\t                },\r\n");
      out.write("\t                prmNames:{\r\n");
      out.write("\t                \trows:\"page.pageSize\",\r\n");
      out.write("\t                \tpage:\"page.curPageNo\",\r\n");
      out.write("\t                \tsort:\"page.orderBy\",\r\n");
      out.write("\t                \torder:\"page.order\",\r\n");
      out.write("\t                \tsearch:\"page._search\",\r\n");
      out.write("\t                \teditoper:\"page._edit\",\r\n");
      out.write("\t                \taddoper:\"page._add\",\r\n");
      out.write("\t                \tdeloper:\"page._delete\"\r\n");
      out.write("\t                },\r\n");
      out.write("\t\t\t\t\tpager : pager_selector,\r\n");
      out.write("\t\t\t\t\taltRows: true,\r\n");
      out.write("\t\t\t\t\t//toppager: true,\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tmultiselect: true,\r\n");
      out.write("\t\t\t\t\t//multikey: \"ctrlKey\",\r\n");
      out.write("\t\t\t        multiboxonly: true,\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\tloadComplete : function() {\r\n");
      out.write("\t\t\t\t\t\tvar table = this;\r\n");
      out.write("\t\t\t\t\t\tsetTimeout(function(){\r\n");
      out.write("\t\t\t\t\t\t\tstyleCheckbox(table);\r\n");
      out.write("\t\t\t\t\t\t\tupdateActionIcons(table);\r\n");
      out.write("\t\t\t\t\t\t\tupdatePagerIcons(table);\r\n");
      out.write("\t\t\t\t\t\t\tenableTooltips(table);\r\n");
      out.write("\t\t\t\t\t\t}, 0);\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\tcaption: \"服务列表\",\r\n");
      out.write("\t\t\t\t\tautowidth: true\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tvar DataSourceTree = function(options) {\r\n");
      out.write("\t\t\t\t\tthis.spjId = options.spjId;\r\n");
      out.write("\t\t\t\t\tthis._data = options.data;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\t\t\tDataSourceTree.prototype.data = function(options, callback) {\r\n");
      out.write("\t\t\t\t\tvar $data = null;\r\n");
      out.write("\t\t\t\t\tif(!(\"name\" in options) && !(\"type\" in options)){\r\n");
      out.write("\t\t\t\t\t\t$data = this._data;//the root tree\r\n");
      out.write("\t\t\t\t\t\tcallback({ data: $data });\r\n");
      out.write("\t\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t\t} else if(\"type\" in options && options.type == \"folder\") {\r\n");
      out.write("\t\t\t\t\t\tif(\"additionalParameters\" in options && \"children\" in options.additionalParameters) {\r\n");
      out.write("\t\t\t\t\t\t\t$data = options.additionalParameters.children;\r\n");
      out.write("\t\t\t\t\t\t\tfor (var key in $data) {\r\n");
      out.write("\t\t\t\t\t\t\t\tif($data[key].id == this.spjId) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$data[key]['additionalParameters'] = eval('('+\"{'item-selected':true}\"+')');\r\n");
      out.write("\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t$data = {}//no data\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\tif($data != null) {//this setTimeout is only for mimicking some random delay\r\n");
      out.write("\t\t\t\t\t\tsetTimeout(function(){callback({ data: $data });} , parseInt(Math.random() * 500) + 200);\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t};\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t//navButtons\r\n");
      out.write("\t\t\t\tjQuery(grid_selector).jqGrid('navGrid',pager_selector,\r\n");
      out.write("\t\t\t\t\t{ \t//navbar options\r\n");
      out.write("\t\t\t\t\t\tedit: true,\r\n");
      out.write("\t\t\t\t\t\tediticon : 'icon-pencil blue',\r\n");
      out.write("\t\t\t\t\t\tadd: true,\r\n");
      out.write("\t\t\t\t\t\taddicon : 'icon-plus-sign purple',\r\n");
      out.write("\t\t\t\t\t\tdel: false,\r\n");
      out.write("\t\t\t\t\t\tdelicon : 'icon-trash red',\r\n");
      out.write("\t\t\t\t\t\tsearch: true,\r\n");
      out.write("\t\t\t\t\t\tsearchicon : 'icon-search orange',\r\n");
      out.write("\t\t\t\t\t\trefresh: true,\r\n");
      out.write("\t\t\t\t\t\trefreshicon : 'icon-refresh green',\r\n");
      out.write("\t\t\t\t\t\tview: true,\r\n");
      out.write("\t\t\t\t\t\tviewicon : 'icon-zoom-in grey',\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t//edit record form\r\n");
      out.write("\t\t\t\t\t\t//closeAfterEdit: true,\r\n");
      out.write("\t\t\t\t\t\twidth: 750,\r\n");
      out.write("\t\t\t\t\t\tmtype: \"POST\",\r\n");
      out.write("\t\t\t\t\t\tcloseAfterEdit: true,\r\n");
      out.write("\t\t\t\t\t\trecreateForm: true,\r\n");
      out.write("\t\t\t\t\t\tbeforeShowForm : function(e) {\r\n");
      out.write("\t\t\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\t\t\tshow_icon(form);\r\n");
      out.write("\t\t\t\t\t\t\tshow_thumbnails(form);\r\n");
      out.write("\t\t\t\t\t\t\tstyle_edit_form(form);\r\n");
      out.write("\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#tr_sc\").css(\"display\", \"none\");\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#project\").css(\"display\", \"none\");\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#tr_project td:eq(1)\").append(\"<div style=\\\"margin-top: -20px;\\\" class=\\\"widget-header header-color-blue2\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+ \"<h4 class=\\\"lighter smaller\\\">选择服务项目</h4></div><div id='serviceTree' class='tree'></div>\");\r\n");
      out.write("\t\t\t\t\t\t\tvar selRowIdx = jQuery(grid_selector).jqGrid(\"getGridParam\", \"selrow\");\r\n");
      out.write("\t\t\t\t\t\t\tvar rowData = jQuery(grid_selector).jqGrid(\"getRowData\", selRowIdx);\r\n");
      out.write("\t\t\t\t\t\t\tvar serviceDS = new DataSourceTree({spjId:rowData['spjId'],data:eval('('+'");
      out.print(spjTree.toString());
      out.write("'+')')});\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#serviceTree\").ace_tree({\r\n");
      out.write("\t\t\t\t\t\t\t\tdataSource: serviceDS,\r\n");
      out.write("\t\t\t\t\t\t\t\tmultiSelect: false,\r\n");
      out.write("\t\t\t\t\t\t\t\tloadingHTML: '<div class=\"tree-loading\"><i class=\"icon-refresh icon-spin blue\"></i></div>',\r\n");
      out.write("\t\t\t\t\t\t\t\t'open-icon' : 'icon-minus',\r\n");
      out.write("\t\t\t\t\t\t\t\t'close-icon' : 'icon-plus',\r\n");
      out.write("\t\t\t\t\t\t\t\t'selectable' : true,\r\n");
      out.write("\t\t\t\t\t\t\t\t'selected-icon' : 'icon-ok',\r\n");
      out.write("\t\t\t\t\t\t\t\t'unselected-icon' : 'icon-remove'\r\n");
      out.write("\t\t\t\t\t\t\t});\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t$(\".tree-folder-header > .tree-folder-name\").each(function(idx,val){\r\n");
      out.write("\t\t\t\t\t\t\t\tif ($(val).text() == $(\"#sc\").val()) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$(val).parent().trigger(\"click\");\r\n");
      out.write("\t\t\t\t\t\t\t\t\treturn false;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t});\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tserializeEditData: function(data) {\r\n");
      out.write("\t\t\t\t\t\t\tvar postdata = \"\";\r\n");
      out.write("\t\t\t\t\t\t\tfor (key in data) {\r\n");
      out.write("\t\t\t\t\t\t\t\tif (postdata.length!=0) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += \"&\";\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t\tif (key == \"sc\" || key == \"icon\" || key == \"iconPN\") {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tcontinue;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t\tif (key == \"id\"){\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata +=\"s.id=\"+jQuery(grid_selector).getRowData(data[key])['s.id'];\r\n");
      out.write("\t\t\t\t\t\t\t\t} else if (key == 'project') {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += \"s.serviceProject.id=\" + $(\"#serviceTree\").data(\"tree\").selectedItems()[0].id;\r\n");
      out.write("\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += key+\"=\"+data[key];\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\treturn postdata;\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterShowForm: function(form) {\r\n");
      out.write("\t\t\t\t\t\t\tform.css(\"height\", \"455px\");\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tonclickSubmit: function(params,postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tparams.url = \"");
      out.print(ctx);
      out.write("/admin/updateSProduct.do\";\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tbeforeSubmit: function(postData, formId) {\r\n");
      out.write("\t\t\t\t\t\t\tif ($(\"#serviceTree\").data(\"tree\").selectedItems().length == 0) {\r\n");
      out.write("\t\t\t\t\t\t\t\treturn [false,\"请选择服务项目！\"];\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\treturn [true, \"success\"];\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterSubmit: function(response, postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tvar data = $.parseJSON(response.responseText);\r\n");
      out.write("\t\t\t\t\t\t\tif (data.success == true) {\r\n");
      out.write("\t\t\t\t\t\t\t\tif ($(\"#icon\").val() != \"\") {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$.ajaxFileUpload(\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\turl: \"");
      out.print(ctx);
      out.write("/admin/uploadSProductPic.do\",\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tsecureuri: false,\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileElementId: 'icon',\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tdata: {id:data.id, \"s.id\":data.id},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tsuccess: function (data, status) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\tif (typeof (data.success) != 'undefined') {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\tif (data.success == true) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(grid_selector).trigger(\" \");\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\talert(\"修改成功\");\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\talert(data.message);\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\terror: function (data, status, e) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t);\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\treturn [data.success, data.message, data.id];\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\twidth: 750,\r\n");
      out.write("\t\t\t\t\t\tmtype: \"POST\",\r\n");
      out.write("\t\t\t\t\t\tcloseAfterAdd: true,\r\n");
      out.write("\t\t\t\t\t\trecreateForm: true,\r\n");
      out.write("\t\t\t\t\t\tbeforeShowForm : function(e) {\r\n");
      out.write("\t\t\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\t\t\tshow_icon(form);\r\n");
      out.write("\t\t\t\t\t\t\tshow_thumbnails(form);\r\n");
      out.write("\t\t\t\t\t\t\tstyle_edit_form(form);\r\n");
      out.write("\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#tr_sc\").css(\"display\", \"none\");\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#project\").css(\"display\", \"none\");\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#tr_project td:eq(1)\").append(\"<div style=\\\"margin-top: -20px;\\\" class=\\\"widget-header header-color-blue2\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+ \"<h4 class=\\\"lighter smaller\\\">选择服务项目</h4></div><div id='serviceTree' class='tree'></div>\");\r\n");
      out.write("\t\t\t\t\t\t\tvar selRowIdx = jQuery(grid_selector).jqGrid(\"getGridParam\", \"selrow\");\r\n");
      out.write("\t\t\t\t\t\t\tvar rowData = jQuery(grid_selector).jqGrid(\"getRowData\", selRowIdx);\r\n");
      out.write("\t\t\t\t\t\t\tvar serviceDS = new DataSourceTree({spjId:-1,data:eval('('+'");
      out.print(spjTree.toString());
      out.write("'+')')});\r\n");
      out.write("\t\t\t\t\t\t\t$(\"#serviceTree\").ace_tree({\r\n");
      out.write("\t\t\t\t\t\t\t\tdataSource: serviceDS,\r\n");
      out.write("\t\t\t\t\t\t\t\tmultiSelect: false,\r\n");
      out.write("\t\t\t\t\t\t\t\tloadingHTML: '<div class=\"tree-loading\"><i class=\"icon-refresh icon-spin blue\"></i></div>',\r\n");
      out.write("\t\t\t\t\t\t\t\t'open-icon' : 'icon-minus',\r\n");
      out.write("\t\t\t\t\t\t\t\t'close-icon' : 'icon-plus',\r\n");
      out.write("\t\t\t\t\t\t\t\t'selectable' : true,\r\n");
      out.write("\t\t\t\t\t\t\t\t'selected-icon' : 'icon-ok',\r\n");
      out.write("\t\t\t\t\t\t\t\t'unselected-icon' : 'icon-remove'\r\n");
      out.write("\t\t\t\t\t\t\t});\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\t$(\".tree-folder-header > .tree-folder-name\").each(function(idx,val){\r\n");
      out.write("\t\t\t\t\t\t\t\tif ($(val).text() == $(\"#sc\").val()) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$(val).parent().trigger(\"click\");\r\n");
      out.write("\t\t\t\t\t\t\t\t\treturn false;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t});\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tserializeEditData: function(data) {\r\n");
      out.write("\t\t\t\t\t\t\tvar postdata = \"\";\r\n");
      out.write("\t\t\t\t\t\t\tfor (key in data) {\r\n");
      out.write("\t\t\t\t\t\t\t\tif (postdata.length!=0) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += \"&\";\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t\tif (key == \"sc\" || key == \"icon\" || key == \"iconPN\" || key == \"id\") {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tcontinue;\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t\tif (key == 'project') {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += \"s.serviceProject.id=\" + $(\"#serviceTree\").data(\"tree\").selectedItems()[0].id;\r\n");
      out.write("\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tpostdata += key+\"=\"+data[key];\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\treturn postdata;\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterShowForm: function(form) {\r\n");
      out.write("\t\t\t\t\t\t\tform.css(\"height\", \"455px\");\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tonclickSubmit: function(params,postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tparams.url = \"");
      out.print(ctx);
      out.write("/admin/addSProduct.do\";\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tbeforeSubmit: function(postData, formId) {\r\n");
      out.write("\t\t\t\t\t\t\tif ($(\"#serviceTree\").data(\"tree\").selectedItems().length == 0) {\r\n");
      out.write("\t\t\t\t\t\t\t\treturn [false,\"请选择服务项目！\"]\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\treturn [true, \"success\"];\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterSubmit: function(response, postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tvar data = $.parseJSON(response.responseText);\r\n");
      out.write("\t\t\t\t\t\t\tif (data.success == true) {\r\n");
      out.write("\t\t\t\t\t\t\t\tif ($(\"#icon\").val() != \"\") {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t$.ajaxFileUpload(\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\turl: \"");
      out.print(ctx);
      out.write("/admin/uploadSProductPic.do\",\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tsecureuri: false,\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileElementId: 'icon',\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tdata: {id:data.id, \"s.id\":data.id},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tsuccess: function (data, status) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\tif (typeof (data.success) != 'undefined') {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\tif (data.success == true) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(grid_selector).trigger(\"reloadGrid\");\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\talert(操作成功);\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t\talert(data.message);\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\terror: function (data, status, e) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\treturn alert('Failed to upload logo!');\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\t);\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\t\t\t\t\t\treturn [data.success, data.message, data.id];\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t//delete record form\r\n");
      out.write("\t\t\t\t\t\tmtype: \"POST\",\r\n");
      out.write("\t\t\t\t\t\treloadAfterSubmit: true,\r\n");
      out.write("\t\t\t\t\t\tonclickSubmit: function(rp_ge, postdata) {\r\n");
      out.write("\t\t\t\t\t\t\trp_ge.url = \"");
      out.print(ctx);
      out.write("/admin/removeShop.do\";\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tserializeDelData: function (postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tvar ids = \"\";\r\n");
      out.write("\t\t\t\t\t\t\tvar idxArr = postdata.id.split(\",\");\r\n");
      out.write("\t\t\t\t\t\t\tfor (var i = 0; i < idxArr.length; i++) {\r\n");
      out.write("\t\t\t\t\t\t\t\tvar rowData = jQuery(grid_selector).getRowData(idxArr[i]);\r\n");
      out.write("\t\t\t\t\t\t\t\tids += rowData['s.id'];\r\n");
      out.write("\t\t\t\t\t\t\t\tif (i != (idxArr.length - 1)) {\r\n");
      out.write("\t\t\t\t\t\t\t\t\tids += \",\";\r\n");
      out.write("\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\treturn \"oper=page._delete&ids=\"+ids;\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterSubmit: function(rsp,postdata) {\r\n");
      out.write("\t\t\t\t\t\t\tvar ret = jQuery.parseJSON(rsp.responseText);\r\n");
      out.write("\t\t\t\t\t\t\tif (ret.ret > 0) {\r\n");
      out.write("\t\t\t\t\t\t\t\treturn [true, ''];\r\n");
      out.write("\t\t\t\t\t\t\t\talert(操作成功);\r\n");
      out.write("\t\t\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\t\t\treturn [false, decodeURIComponent(ret.detail)]; // detail is encoded by utf-8\r\n");
      out.write("\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\trecreateForm: true,\r\n");
      out.write("\t\t\t\t\t\tbeforeShowForm : function(e) {\r\n");
      out.write("\t\t\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\t\t\tif(form.data('styled')) return false;\r\n");
      out.write("\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\t\t\tstyle_delete_form(form);\r\n");
      out.write("\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\tform.data('styled', true);\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tonClick : function(e) {\r\n");
      out.write("\t\t\t\t\t\t\talert(1);\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t//search form\r\n");
      out.write("\t\t\t\t\t\trecreateForm: true,\r\n");
      out.write("\t\t\t\t\t\tsopt:[\"eq\",'cn'],\r\n");
      out.write("\t\t\t\t\t\tafterShowSearch: function(e){\r\n");
      out.write("\t\t\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-title').wrap('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\t\t\tstyle_search_form(form);\r\n");
      out.write("\t\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\tafterRedraw: function(){\r\n");
      out.write("\t\t\t\t\t\t\tstyle_search_filters($(this));\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t,\r\n");
      out.write("\t\t\t\t\t\tmultipleSearch: true,\r\n");
      out.write("\t\t\t\t\t\t/**\r\n");
      out.write("\t\t\t\t\t\tmultipleGroup:true,\r\n");
      out.write("\t\t\t\t\t\tshowQuery: true\r\n");
      out.write("\t\t\t\t\t\t*/\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t//view record form\r\n");
      out.write("\t\t\t\t\t\trecreateForm: true,\r\n");
      out.write("\t\t\t\t\t\tbeforeShowForm: function(e){\r\n");
      out.write("\t\t\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-title').wrap('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t)\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction getPathAndName(pathAndName) {\r\n");
      out.write("\t\t\t\t\t// path:name|path:name\r\n");
      out.write("\t\t\t\t\tif (pathAndName == null || pathAndName == \"\") {\r\n");
      out.write("\t\t\t\t\t\treturn null;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tvar pn = pathAndName.split(\";\");\r\n");
      out.write("\t\t\t\t\tif (pn.length != 2) {\r\n");
      out.write("\t\t\t\t\t\treturn null;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\treturn pn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction show_icon(form) {\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_icon td:eq(1) input:eq(0)\").attr(\"accept\", \"image/*\");\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_icon td:eq(1) input:eq(0)\").css(\"display\", \"none\");\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_icon td:eq(1) input:eq(0)\").change(function(e) {\r\n");
      out.write("\t\t\t\t\t\tif (e.target.files[0].size > 2097152) {\r\n");
      out.write("\t\t\t\t\t\t\talert(\"请选择小于2M的图片！\");\r\n");
      out.write("\t\t\t\t\t\t\te.value=\"\";\r\n");
      out.write("\t\t\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\tvar file = e.target.files[0];\r\n");
      out.write("\t\t\t\t\t\tvar reader = new FileReader()\r\n");
      out.write("\t\t\t            reader.onload = function(elem) {\r\n");
      out.write("\t\t\t                jQuery(\"#icon-img\").attr(\"src\", elem.target.result);\r\n");
      out.write("\t\t\t            }\r\n");
      out.write("\t\t\t            reader.readAsDataURL(file)\r\n");
      out.write("\t\t\t\t\t});\r\n");
      out.write("\t\t\t\t\tvar tmp = getPathAndName(form.find(\"#tr_iconPN td:eq(1) input:eq(0)\").val());\r\n");
      out.write("\t\t\t\t\tvar src = \"\";\r\n");
      out.write("\t\t\t\t\tif (tmp == null || tmp[1] == \"\") {\r\n");
      out.write("\t\t\t\t\t\tsrc = \"../assets/images/add_pic.png\";\r\n");
      out.write("\t\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\t\tsrc = \"");
      out.print(ctx);
      out.write("/displayPic.do?imagePath=\"+tmp[0]+\"&imageName=\"+tmp[1];\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tvar img = \"<img id=\\\"icon-img\\\" onclick=\\\"jQuery('#icon').trigger('click')\\\" src=\\\"\"+src+\"\\\" style=\\\"max-width: 110px; max-height: 110px;\\\"/>\";\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_icon td:eq(1)\").append(jQuery(img));\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction show_thumbnails(form) {\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(0)\").css(\"vertical-align\", \"top\");\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(1) input:eq(0)\").css(\"display\",\"none\");\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(1) input:eq(0)\").attr(\"id\", \"pics\");\r\n");
      out.write("\t\t\t\t\tvar controls = jQuery(\"<div class=\\\"controls\\\"></div>\");\r\n");
      out.write("\t\t\t\t\tvar J_UploadQueueContainer = jQuery(\"<div data-url=\\\"\\\" id=\\\"J_UploadQueueContainer\\\"></div>\");\r\n");
      out.write("\t\t\t\t\tvar J_UploadQueue = jQuery(\"<ul class=\\\"upload-queue ks-uploader-queue imageUploader-queue\\\" id=\\\"J_UploadQueue\\\"></ul>\");\r\n");
      out.write("\t\t\t\t\tvar arrFile = form.find(\"#tr_pics td:eq(1) input:eq(0)\").val().split(\"|\");\r\n");
      out.write("\t\t\t\t\tvar maxCount = ");
      out.print(maxThumbnail);
      out.write(";\r\n");
      out.write("\t\t\t\t\tif (maxCount == null) {\r\n");
      out.write("\t\t\t\t\t\tmaxCount = 1;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tvar i=0, realCnt = 0;\r\n");
      out.write("\t\t\t\t\tfor (; i<arrFile.length && i<maxCount; i++) {\r\n");
      out.write("\t\t\t\t\t\tvar tmp = getPathAndName(arrFile[i]);\r\n");
      out.write("\t\t\t\t\t\tif (tmp == null) {\r\n");
      out.write("\t\t\t\t\t\t\tcontinue;\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\tvar first = \"\", last = \"\";\r\n");
      out.write("\t\t\t\t\t\tif (i == 0) {\r\n");
      out.write("\t\t\t\t\t\t\tfirst = \"first\";\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\tif (i == (arrFile.length - 1)) {\r\n");
      out.write("\t\t\t\t\t\t\tlast = \"last\";\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\tvar idx = tmp[1].substring(0,tmp[1].indexOf(\".\"));\r\n");
      out.write("\t\t\t\t\t\tvar src = \"");
      out.print(ctx);
      out.write("/displayPic.do?imagePath=\"+tmp[0]+\"&imageName=\"+tmp[1];\r\n");
      out.write("\t\t\t\t\t\tvar fileLi = jQuery(\"<li class=\\\"pic-box control-group \"+ first + \" \" + last + \" success\\\" id=\\\"file-\" + idx + \"\\\"></li>\");\r\n");
      out.write("\t\t\t\t\t\tvar showPic = \"<div class=\\\"pic sh-pic\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+ \"<a href=\\\"javascript:void(0);\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\t\"<img class=\\\"J_Pic_file-\" + idx + \"\\\" id=\\\"J_Pic_file-\" + idx + \"\\\" src=\\\"\"+src+\"\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"</a>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t//+\"<span class=\\\"rotate\\\"><b class=\\\"rotate-icon\\\"></b>旋转图片</span>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"<div class=\\\" J_Mask_file-\"+idx+\" pic-mask\\\" style=\\\"display: none;\\\"></div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"<div class=\\\"status-wrapper\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<div class=\\\"status waiting-status\\\" style=\\\"display: none;\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t\t<p>等待上传<br>请稍候</p>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<div class=\\\"status start-status progress-status success-status\\\" style=\\\"\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t\t\t<div class=\\\"J_ProgressBar_file-\"+idx+\" ks-progress-bar\\\" style=\\\"width: 100px; display: none;\\\" role=\\\"progressbar\\\" aria-valuemin=\\\"0\\\" aria-valuemax=\\\"100\\\" aria-valuenow=\\\"100\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t\t\t<div data-value=\\\"100\\\" class=\\\"ks-progress-bar-value\\\" style=\\\"width: 100px;\\\"></div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<div class=\\\"status error-status\\\" style=\\\"display: none;\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t\t<p class=\\\"J_ErrorMsg_file-\"+idx+\"\\\">服务器故障，请稍候再试！</p>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"</div>\";\r\n");
      out.write("\t\t\t\t\t\tvar picAddon = \"<div class=\\\"pic-addon\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t//+\"<input id=\\\"J_Desc_file-\" + idx + \"\\\" placeholder=\\\"点击图片的响应地址,例如: http://www.hongxi365.com/admin/ \\\"\"\r\n");
      out.write("\t\t\t\t\t\t\t\t//+\" type=\\\"text\\\" size=\\\"60\\\" maxlength=\\\"255\\\" onchange=\\\"updateImageFileInfo('ads_picture')\\\" \"\r\n");
      out.write("\t\t\t\t\t\t\t\t//+\" value='\" + tmp[2] + \"' >\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"<div class=\\\"bar clearfix\\\">\"\r\n");
      out.write("\t\t\t\t\t\t\t\t//+\"\t<label class=\\\"radio\\\"><input type=\\\"radio\\\" name=\\\"setMain\\\" class=\\\"set-main\\\" value=\\\"\\\"> 设为首图</label>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<b class=\\\"moveup\\\">上移</b>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<b class=\\\"movedown\\\">下移</b>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"\t<b class=\\\"del J_Del_file-\"+idx+\"\\\">删除</b>\"\r\n");
      out.write("\t\t\t\t\t\t\t\t+\"</div>\"\r\n");
      out.write("\t\t\t\t\t\t\t+\"</div>\";\r\n");
      out.write("\t\t\t\t\t\tfileLi.append(jQuery(showPic));\r\n");
      out.write("\t\t\t\t\t\tfileLi.append(jQuery(picAddon));\r\n");
      out.write("\t\t\t\t\t\tJ_UploadQueue.append(fileLi);\r\n");
      out.write("\t\t\t\t\t\trealCnt++;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tJ_UploadQueueContainer.append(J_UploadQueue);\r\n");
      out.write("\t\t\t\t\tcontrols.append(J_UploadQueueContainer);\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(1)\").append(controls);\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tvar jUpic = \"<div class=\\\"upload\\\" id=\\\"J_UploadPic\\\" \";\r\n");
      out.write("\t\t\t\t\tif (realCnt>=maxCount) {\r\n");
      out.write("\t\t\t\t\t\tjUpic += \"style=\\\"display: none\\\" \";\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tjUpic += \"/>\";\r\n");
      out.write("\t\t\t\t\tvar J_UploadPic = jQuery(jUpic);\r\n");
      out.write("\t\t\t\t\tvar upload_inner = jQuery(\"<div class=\\\"upload-inner\\\" />\");\r\n");
      out.write("\t\t\t\t\tupload_inner.append(jQuery(\"<b></b>\"));\r\n");
      out.write("\t\t\t\t\tvar innerHtml = \"<input type=\\\"file\\\" accept='image/*' onchange='ajax_upload_pics(\\\"thumbnailFile\\\",\\\"product_detail_picture\\\",\\\"J_UploadQueue\\\",addLiNode, this, \" + maxCount + \");' class=\\\"file-input\\\" hidefocus=\\\"true\\\"\"\r\n");
      out.write("\t\t\t\t\t\t+ \" id=\\\"thumbnailFile\\\" name=\\\"file\\\" style=\\\"font-family: Arial; height: 110px; width:110px;\"\r\n");
      out.write("\t\t\t\t\t\t+\" margin: 0px; padding: 0px; cursor: pointer; opacity: 0;\\\">\";\r\n");
      out.write("\t\t\t\t\tupload_inner.append(jQuery(innerHtml));\r\n");
      out.write("\t\t\t\t\tJ_UploadPic.append(upload_inner);\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(1)\").append(J_UploadPic);\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tform.find(\"#tr_pics td:eq(1)\").append(jQuery(\"<span class=\\\"upload-tip\\\">最多可上传\"+maxCount+\"张照片，图片每张最大2M</span>\"));\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tonclickLiOper(maxCount);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\tfunction style_edit_form(form) {\r\n");
      out.write("\t\t\t\t\t//enable datepicker on \"sdate\" field and switches for \"stock\" field\r\n");
      out.write("\t\t\t\t\tform.find('input[name=sdate]').datepicker({format:'yyyy-mm-dd' , autoclose:true})\r\n");
      out.write("\t\t\t\t\t\t.end().find('input[name=stock]')\r\n");
      out.write("\t\t\t\t\t\t\t  .addClass('ace ace-switch ace-switch-5').wrap('<label class=\"inline\" />').after('<span class=\"lbl\"></span>');\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\t//update buttons classes\r\n");
      out.write("\t\t\t\t\tvar buttons = form.next().find('.EditButton .fm-button');\r\n");
      out.write("\t\t\t\t\tbuttons.addClass('btn btn-sm').find('[class*=\"-icon\"]').remove();//ui-icon, s-icon\r\n");
      out.write("\t\t\t\t\tbuttons.eq(0).addClass('btn-primary').prepend('<i class=\"icon-ok\"></i>');\r\n");
      out.write("\t\t\t\t\tbuttons.eq(1).prepend('<i class=\"icon-remove\"></i>')\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tbuttons = form.next().find('.navButton a');\r\n");
      out.write("\t\t\t\t\tbuttons.find('.ui-icon').remove();\r\n");
      out.write("\t\t\t\t\tbuttons.eq(0).append('<i class=\"icon-chevron-left\"></i>');\r\n");
      out.write("\t\t\t\t\tbuttons.eq(1).append('<i class=\"icon-chevron-right\"></i>');\t\t\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\tfunction style_delete_form(form) {\r\n");
      out.write("\t\t\t\t\tvar buttons = form.next().find('.EditButton .fm-button');\r\n");
      out.write("\t\t\t\t\tbuttons.addClass('btn btn-sm').find('[class*=\"-icon\"]').remove();//ui-icon, s-icon\r\n");
      out.write("\t\t\t\t\tbuttons.eq(0).addClass('btn-danger').prepend('<i class=\"icon-trash\"></i>');\r\n");
      out.write("\t\t\t\t\tbuttons.eq(1).prepend('<i class=\"icon-remove\"></i>')\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction style_search_filters(form) {\r\n");
      out.write("\t\t\t\t\tform.find('.delete-rule').val('X');\r\n");
      out.write("\t\t\t\t\tform.find('.add-rule').addClass('btn btn-xs btn-primary');\r\n");
      out.write("\t\t\t\t\tform.find('.add-group').addClass('btn btn-xs btn-success');\r\n");
      out.write("\t\t\t\t\tform.find('.delete-group').addClass('btn btn-xs btn-danger');\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tfunction style_search_form(form) {\r\n");
      out.write("\t\t\t\t\tvar dialog = form.closest('.ui-jqdialog');\r\n");
      out.write("\t\t\t\t\tvar buttons = dialog.find('.EditTable')\r\n");
      out.write("\t\t\t\t\tbuttons.find('.EditButton a[id*=\"_reset\"]').addClass('btn btn-sm btn-info').find('.ui-icon').attr('class', 'icon-retweet');\r\n");
      out.write("\t\t\t\t\tbuttons.find('.EditButton a[id*=\"_query\"]').addClass('btn btn-sm btn-inverse').find('.ui-icon').attr('class', 'icon-comment-alt');\r\n");
      out.write("\t\t\t\t\tbuttons.find('.EditButton a[id*=\"_search\"]').addClass('btn btn-sm btn-purple').find('.ui-icon').attr('class', 'icon-search');\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction beforeDeleteCallback(e) {\r\n");
      out.write("\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\tif(form.data('styled')) {\r\n");
      out.write("\t\t\t\t\t\treturn false;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\tstyle_delete_form(form);\r\n");
      out.write("\t\t\t\t\tform.data('styled', true);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tfunction beforeEditCallback(e) {\r\n");
      out.write("\t\t\t\t\tvar form = $(e[0]);\r\n");
      out.write("\t\t\t\t\tform.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class=\"widget-header\" />')\r\n");
      out.write("\t\t\t\t\tstyle_edit_form(form);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t//it causes some flicker when reloading or navigating grid\r\n");
      out.write("\t\t\t\t//it may be possible to have some custom formatter to do this as the grid is being created to prevent this\r\n");
      out.write("\t\t\t\t//or go back to default browser checkbox styles for the grid\r\n");
      out.write("\t\t\t\tfunction styleCheckbox(table) {\r\n");
      out.write("\t\t\t\t/**\r\n");
      out.write("\t\t\t\t\t$(table).find('input:checkbox').addClass('ace')\r\n");
      out.write("\t\t\t\t\t.wrap('<label />')\r\n");
      out.write("\t\t\t\t\t.after('<span class=\"lbl align-top\" />')\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t\t$('.ui-jqgrid-labels th[id*=\"_cb\"]:first-child')\r\n");
      out.write("\t\t\t\t\t.find('input.cbox[type=checkbox]').addClass('ace')\r\n");
      out.write("\t\t\t\t\t.wrap('<label />').after('<span class=\"lbl align-top\" />');\r\n");
      out.write("\t\t\t\t*/\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t//unlike navButtons icons, action icons in rows seem to be hard-coded\r\n");
      out.write("\t\t\t\t//you can change them like this in here if you want\r\n");
      out.write("\t\t\t\tfunction updateActionIcons(table) {\r\n");
      out.write("\t\t\t\t\t/**\r\n");
      out.write("\t\t\t\t\tvar replacement = \r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-pencil' : 'icon-pencil blue',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-trash' : 'icon-trash red',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-disk' : 'icon-ok green',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-cancel' : 'icon-remove red'\r\n");
      out.write("\t\t\t\t\t};\r\n");
      out.write("\t\t\t\t\t$(table).find('.ui-pg-div span.ui-icon').each(function(){\r\n");
      out.write("\t\t\t\t\t\tvar icon = $(this);\r\n");
      out.write("\t\t\t\t\t\tvar $class = $.trim(icon.attr('class').replace('ui-icon', ''));\r\n");
      out.write("\t\t\t\t\t\tif($class in replacement) icon.attr('class', 'ui-icon '+replacement[$class]);\r\n");
      out.write("\t\t\t\t\t})\r\n");
      out.write("\t\t\t\t\t*/\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t//replace icons with FontAwesome icons like above\r\n");
      out.write("\t\t\t\tfunction updatePagerIcons(table) {\r\n");
      out.write("\t\t\t\t\tvar replacement = \r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-seek-first' : 'icon-double-angle-left bigger-140',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-seek-prev' : 'icon-angle-left bigger-140',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-seek-next' : 'icon-angle-right bigger-140',\r\n");
      out.write("\t\t\t\t\t\t'ui-icon-seek-end' : 'icon-double-angle-right bigger-140'\r\n");
      out.write("\t\t\t\t\t};\r\n");
      out.write("\t\t\t\t\t$('.ui-pg-table:not(.navtable) > tbody > tr > .ui-pg-button > .ui-icon').each(function(){\r\n");
      out.write("\t\t\t\t\t\tvar icon = $(this);\r\n");
      out.write("\t\t\t\t\t\tvar $class = $.trim(icon.attr('class').replace('ui-icon', ''));\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\tif($class in replacement) icon.attr('class', 'ui-icon '+replacement[$class]);\r\n");
      out.write("\t\t\t\t\t})\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\tfunction enableTooltips(table) {\r\n");
      out.write("\t\t\t\t\t$('.navtable .ui-pg-button').tooltip({container:'body'});\r\n");
      out.write("\t\t\t\t\t$(table).find('.ui-pg-div').tooltip({container:'body'});\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\t//var selr = jQuery(grid_selector).jqGrid('getGridParam','selrow');\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t</body>\r\n");
      out.write("</html>");
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else log(t.getMessage(), t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
